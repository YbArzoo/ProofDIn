<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProofdIn - Candidate Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #4a6cf7;
            --primary-dark: #3a56d4;
            --primary-light: #eef2ff;
            --secondary: #6c757d;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --border-radius: 8px;
            --box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        body {
            background-color: #f5f7fb;
            color: var(--dark);
            line-height: 1.6;
        }

        /* Header & Navigation */
        .dashboard-header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .dashboard-nav {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 42px;
            height: 42px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: 8px;
        }

        .logo-icon i {
            color: white;
            font-size: 1.3rem;
        }

        .logo-text {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .btn {
            padding: 0.6rem 1.5rem;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 1rem;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

        /* Main Dashboard Layout */
        .dashboard-container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
        }

        /* Sidebar */
        .sidebar {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--box-shadow);
            height: fit-content;
        }

        .sidebar-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            margin-bottom: 0.8rem;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 0.8rem 1rem;
            text-decoration: none;
            color: var(--secondary);
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .sidebar-menu a:hover,
        .sidebar-menu a.active {
            background-color: var(--primary-light);
            color: var(--primary);
        }

        .sidebar-menu i {
            width: 20px;
            text-align: center;
        }

        /* Dashboard Main Content */
        .dashboard-main {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        /* Welcome Card */
        .welcome-card {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--box-shadow);
        }

        .welcome-card h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .welcome-card p {
            opacity: 0.9;
            margin-bottom: 1.5rem;
        }

        .welcome-stats {
            display: flex;
            gap: 2rem;
            margin-top: 1.5rem;
        }

        .stat {
            display: flex;
            flex-direction: column;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* Section Cards */
        .section-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--box-shadow);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
        }

        .section-subtitle {
            color: var(--secondary);
            margin-bottom: 1.5rem;
        }

        /* Tailored Resume Section */
        .resume-tailor {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 1rem;
        }

        .job-input {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .job-input textarea {
            width: 100%;
            height: 150px;
            padding: 1rem;
            border: 1px solid #e0e0e0;
            border-radius: var(--border-radius);
            resize: vertical;
            font-size: 1rem;
        }

        .job-input textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        .tailored-resume-preview {
            background-color: #f9f9f9;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            border: 1px dashed #ccc;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .tailored-resume-preview i {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        /* Skills Grid */
        .skills-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .skill-card {
            border: 1px solid #e0e0e0;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            transition: var(--transition);
        }

        .skill-card:hover {
            border-color: var(--primary);
            box-shadow: var(--box-shadow);
        }

        .skill-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .skill-name {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .skill-level {
            background-color: var(--primary-light);
            color: var(--primary);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .skill-details {
            color: var(--secondary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .skill-last-used {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            color: var(--secondary);
        }

        .skill-attachments {
            margin-top: 1rem;
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .attachment-tag {
            background-color: #f0f0f0;
            padding: 0.3rem 0.8rem;
            border-radius: 4px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Skill Gaps Section */
        .skill-gaps {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 1rem;
        }

        .missing-skills-list {
            list-style: none;
        }

        .missing-skill {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid #f0f0f0;
        }

        .missing-skill:last-child {
            border-bottom: none;
        }

        .practice-project {
            background-color: #f9f9f9;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .practice-project h4 {
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        /* Portfolio Section */
        .portfolio-settings {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 1rem;
        }

        .portfolio-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background-color: #f9f9f9;
            border-radius: var(--border-radius);
            margin-bottom: 1rem;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(30px);
        }

        .privacy-controls {
            margin-top: 1.5rem;
        }

        .privacy-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid #f0f0f0;
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .dashboard-container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .resume-tailor,
            .skill-gaps,
            .portfolio-settings {
                grid-template-columns: 1fr;
            }
            
            .skills-grid {
                grid-template-columns: 1fr;
            }
            
            .welcome-stats {
                flex-direction: column;
                gap: 1rem;
            }
            
            .dashboard-nav {
                flex-direction: column;
                gap: 1rem;
            }
        }
        #resume-content-display > :first-child {
            margin-top: 0 !important;
            padding-top: 0 !important;
        }

        #resume-content-display h1, 
        #resume-content-display h2, 
        #resume-content-display h3 {
            margin-top: 0.5rem; 
        }
    </style>
</head>
<body>
    <!-- Dashboard Header -->
    <header class="dashboard-header">
        <nav class="dashboard-nav">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-search-check"></i>
                </div>
                <div class="logo-text">ProofdIn</div>
            </div>
            
            <div class="user-menu">
                <div class="user-profile">
                    <div class="avatar" id="user-avatar">JD</div>
                    <div>
                        <div id="user-name" style="font-weight: 600;">Candidate Name</div>
                        <div id="user-role" style="font-size: 0.9rem; color: var(--secondary);">Candidate</div>
                    </div>
                </div>
                <button class="btn btn-primary" id="logout-btn">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
            
        </nav>
    </header>

    <!-- Dashboard Content -->
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-title">
                <i class="fas fa-tachometer-alt"></i> Dashboard
            </div>
            <ul class="sidebar-menu">
                <li><a href="#tailored-resume" class="active"><i class="fas fa-file-pdf"></i> Tailored Resumes</a></li>
                <li><a href="#skills-grid"><i class="fas fa-th-large"></i> Skills Grid</a></li>
                <li><a href="#skill-proof"><i class="fas fa-link"></i> Skill Proof</a></li>
                <li><a href="#skill-gaps"><i class="fas fa-chart-line"></i> Skill Gaps</a></li>
                <li><a href="#portfolio"><i class="fas fa-globe"></i> Portfolio</a></li>
                <li><a href="#settings"><i class="fas fa-cog"></i> Settings</a></li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="dashboard-main">
            <!-- Welcome Card -->
            <section class="welcome-card">
                <h1 id="welcome-heading">Welcome back!</h1>
                <p id="welcome-subtext">
                    Your resume is 85% optimized. Continue improving to increase your interview chances.
                </p>
                <div class="welcome-stats">
                    <div class="stat">
                        <div class="stat-value">12</div>
                        <div class="stat-label">Tailored Resumes</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value">24</div>
                        <div class="stat-label">Skills Tracked</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value">8</div>
                        <div class="stat-label">Projects Linked</div>
                    </div>
                </div>
            </section>
            

            <!-- Tailored Resume Section -->
            <section id="tailored-resume" class="section-card">
                <div class="section-header">
                    <h2 class="section-title">Tailored Resumes</h2>
                    <button class="btn btn-primary">
                        <i class="fas fa-download"></i> Download All
                    </button>
                </div>
                <p class="section-subtitle">One resume, many versions: Paste a job post to get a tailored PDF in 1 click.</p>
                
                <div class="resume-tailor">
                    <div class="job-input">
                        <textarea id="jd-input" placeholder="Paste the job description here..." style="min-height: 200px;">Senior Frontend Developer with 5+ years of experience in React...</textarea>
                        
                        <button id="generate-btn" class="btn btn-primary" onclick="generateResume()">
                            <i class="fas fa-magic"></i> Generate Tailored Resume
                        </button>
                    </div>
                    
                    <div id="success-card" class="tailored-resume-preview" style="display: none;">
                        <i class="fas fa-file-pdf"></i>
                        <h3 id="generated-filename">Tailored_Resume.pdf</h3>
                        <p id="tailored-for">Tailored for: TechCorp Inc.</p>
                        <p id="generated-date">Generated: Just now</p>
                        
                        <div style="margin-top: 1rem; display: flex; gap: 1rem;">
                            <button class="btn btn-primary" style="padding: 0.5rem 1rem;" onclick="openPreviewModal()">
                                <i class="fas fa-eye"></i> Preview
                            </button>
                            <button class="btn" style="padding: 0.5rem 1rem; background-color: #f0f0f0;" onclick="downloadPDF()">
                                <i class="fas fa-download"></i> Download
                            </button>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 2rem;">
                    <h3 style="margin-bottom: 1rem;">Recent Tailored Resumes</h3>
                    <div style="display: flex; gap: 1rem; overflow-x: auto; padding: 0.5rem 0;">
                        <div class="tailored-resume-preview" style="min-width: 200px;">
                            <i class="fas fa-file-pdf"></i>
                            <p>Full Stack Developer.pdf</p>
                        </div>
                        <div class="tailored-resume-preview" style="min-width: 200px;">
                            <i class="fas fa-file-pdf"></i>
                            <p>React Developer.pdf</p>
                        </div>
                    </div>
                </div>

                <div id="preview-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; justify-content: center; align-items: center;">
                    <div style="background: white; width: 80%; max-width: 800px; height: 85%; padding: 25px; border-radius: 8px; position: relative; display: flex; flex-direction: column; box-shadow: 0 5px 15px rgba(0,0,0,0.3);">
                        
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px;">
                            <h3 style="margin: 0;">Resume Preview</h3>
                            <button onclick="closePreviewModal()" style="border: none; background: transparent; font-size: 1.5rem; cursor: pointer; color: #666;">&times;</button>
                        </div>

                        <div id="resume-content-display" style="flex: 1; overflow-y: auto; font-family: 'Times New Roman', serif; padding: 20px; border: 1px solid #eee; background: #fff; color: #000; line-height: 1.5;">
                            </div>

                        <div style="margin-top: 15px; text-align: right; display: flex; justify-content: flex-end; gap: 10px;">
                            <button class="btn" style="background: #e0e0e0; color: #333;" onclick="closePreviewModal()">Close</button>
                            <button class="btn btn-primary" onclick="downloadPDF()">Download PDF</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Skills Grid Section -->
            <section id="skills-grid" class="section-card">
                <div class="section-header">
                    <h2 class="section-title">Skills Grid</h2>
                    <button class="btn btn-primary">
                        <i class="fas fa-plus"></i> Add Skill
                    </button>
                </div>
                <p class="section-subtitle">See your skills clearly: A grid shows each skill and when you last used it.</p>
                
                <div class="skills-grid">
                    <div class="skill-card">
                        <div class="skill-header">
                            <div class="skill-name">React</div>
                            <div class="skill-level">Expert</div>
                        </div>
                        <div class="skill-details">
                            JavaScript library for building user interfaces
                        </div>
                        <div class="skill-last-used">
                            <i class="far fa-calendar"></i>
                            <span>Last used: 2 weeks ago</span>
                        </div>
                        <div class="skill-attachments">
                            <span class="attachment-tag">
                                <i class="fas fa-link"></i> GitHub PR
                            </span>
                            <span class="attachment-tag">
                                <i class="fas fa-video"></i> Demo
                            </span>
                        </div>
                    </div>
                    
                    <div class="skill-card">
                        <div class="skill-header">
                            <div class="skill-name">TypeScript</div>
                            <div class="skill-level">Advanced</div>
                        </div>
                        <div class="skill-details">
                            Typed superset of JavaScript
                        </div>
                        <div class="skill-last-used">
                            <i class="far fa-calendar"></i>
                            <span>Last used: 1 week ago</span>
                        </div>
                        <div class="skill-attachments">
                            <span class="attachment-tag">
                                <i class="fas fa-certificate"></i> Certificate
                            </span>
                        </div>
                    </div>
                    
                    <div class="skill-card">
                        <div class="skill-header">
                            <div class="skill-name">Node.js</div>
                            <div class="skill-level">Intermediate</div>
                        </div>
                        <div class="skill-details">
                            JavaScript runtime for server-side development
                        </div>
                        <div class="skill-last-used">
                            <i class="far fa-calendar"></i>
                            <span>Last used: 1 month ago</span>
                        </div>
                        <div class="skill-attachments">
                            <span class="attachment-tag">
                                <i class="fas fa-link"></i> Live Project
                            </span>
                        </div>
                    </div>
                    
                    
                </div>
            </section>

            <!-- Skill Proof Section -->
            <section id="skill-proof" class="section-card">
                <div class="section-header">
                    <h2 class="section-title">Skill Proof</h2>
                    <button class="btn btn-primary">
                        <i class="fas fa-link"></i> Add Proof
                    </button>
                </div>
                <p class="section-subtitle">Prove what you know: Attach links to PRs, demos, or certificates for each skill.</p>
                
                <div style="margin-top: 1.5rem;">
                    <div class="skill-card" style="margin-bottom: 1rem;">
                        <div class="skill-header">
                            <div class="skill-name">React Performance Optimization</div>
                            <div class="skill-level">Proof Added</div>
                        </div>
                        <div class="skill-details">
                            Reduced bundle size by 40% and improved Lighthouse score from 65 to 95
                        </div>
                        <div class="skill-attachments" style="margin-top: 1rem;">
                            <span class="attachment-tag" style="background-color: #e8f5e9; color: #2e7d32;">
                                <i class="fab fa-github"></i> GitHub PR #245
                            </span>
                            <span class="attachment-tag" style="background-color: #e3f2fd; color: #1565c0;">
                                <i class="fas fa-chart-line"></i> Performance Report
                            </span>
                            <span class="attachment-tag" style="background-color: #f3e5f5; color: #7b1fa2;">
                                <i class="fas fa-video"></i> Demo Video
                            </span>
                        </div>
                    </div>
                    
                    <div class="skill-card">
                        <div class="skill-header">
                            <div class="skill-name">TypeScript Migration</div>
                            <div class="skill-level">Proof Added</div>
                        </div>
                        <div class="skill-details">
                            Successfully migrated 15K lines of JavaScript to TypeScript
                        </div>
                        <div class="skill-attachments" style="margin-top: 1rem;">
                            <span class="attachment-tag" style="background-color: #e8f5e9; color: #2e7d32;">
                                <i class="fab fa-github"></i> GitHub PR #189
                            </span>
                            <span class="attachment-tag" style="background-color: #fff8e1; color: #ff8f00;">
                                <i class="fas fa-file-code"></i> Migration Guide
                            </span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Skill Gaps Section -->
            <section id="skill-gaps" class="section-card">
                <div class="section-header">
                    <h2 class="section-title">Skill Gaps</h2>
                    <button class="btn btn-primary">
                        <i class="fas fa-sync-alt"></i> Re-analyze
                    </button>
                </div>
                <p class="section-subtitle">Close the gaps: AI suggests missing skills and tiny practice projects to learn them.</p>
                
                <div class="skill-gaps">
                    <div>
                        <h3 style="margin-bottom: 1rem;">Missing Skills for "Senior Frontend Developer"</h3>
                        <ul class="missing-skills-list">
                            <li class="missing-skill">
                                <div>
                                    <div style="font-weight: 600;">GraphQL</div>
                                    <div style="font-size: 0.9rem; color: var(--secondary);">Required by 65% of senior roles</div>
                                </div>
                                <button class="btn" style="padding: 0.3rem 0.8rem; font-size: 0.9rem;">
                                    Learn
                                </button>
                            </li>
                            <li class="missing-skill">
                                <div>
                                    <div style="font-weight: 600;">WebSocket</div>
                                    <div style="font-size: 0.9rem; color: var(--secondary);">Required by 45% of senior roles</div>
                                </div>
                                <button class="btn" style="padding: 0.3rem 0.8rem; font-size: 0.9rem;">
                                    Learn
                                </button>
                            </li>
                            <li class="missing-skill">
                                <div>
                                    <div style="font-weight: 600;">Jest Advanced Testing</div>
                                    <div style="font-size: 0.9rem; color: var(--secondary);">Required by 70% of senior roles</div>
                                </div>
                                <button class="btn" style="padding: 0.3rem 0.8rem; font-size: 0.9rem;">
                                    Learn
                                </button>
                            </li>
                        </ul>
                    </div>
                    
                    <div>
                        <h3 style="margin-bottom: 1rem;">Recommended Practice Projects</h3>
                        <div class="practice-project">
                            <h4>Build a Real-time Chat App</h4>
                            <p>Practice WebSocket and real-time data handling. Estimated time: 4-6 hours.</p>
                            <button class="btn btn-primary" style="margin-top: 0.5rem; padding: 0.5rem 1rem;">
                                Start Project
                            </button>
                        </div>
                        <div class="practice-project">
                            <h4>Create a GraphQL API</h4>
                            <p>Learn GraphQL queries, mutations, and subscriptions. Estimated time: 3-5 hours.</p>
                            <button class="btn btn-primary" style="margin-top: 0.5rem; padding: 0.5rem 1rem;">
                                Start Project
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Portfolio Section -->
            <section id="portfolio" class="section-card">
                <div class="section-header">
                    <h2 class="section-title">Portfolio Showcase</h2>
                    <button class="btn btn-primary">
                        <i class="fas fa-external-link-alt"></i> View Portfolio
                    </button>
                </div>
                <p class="section-subtitle">Showcase safely: Optional public portfolio page, with privacy controls for what's shown.</p>
                
                <div class="portfolio-settings">
                    <div>
                        <div class="portfolio-toggle">
                            <div>
                                <div style="font-weight: 600;">Public Portfolio</div>
                                <div style="font-size: 0.9rem; color: var(--secondary);">Your portfolio is currently public</div>
                            </div>
                            <label class="switch">
                                <input type="checkbox" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        
                        <div class="privacy-controls">
                            <h4 style="margin-bottom: 1rem;">Privacy Controls</h4>
                            <div class="privacy-item">
                                <div>
                                    <div style="font-weight: 600;">Show Contact Information</div>
                                    <div style="font-size: 0.9rem; color: var(--secondary);">Email and phone number</div>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="privacy-item">
                                <div>
                                    <div style="font-weight: 600;">Show Current Employer</div>
                                    <div style="font-size: 0.9rem; color: var(--secondary);">Your current company</div>
                                </div>
                                <label class="switch">
                                    <input type="checkbox">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="privacy-item">
                                <div>
                                    <div style="font-weight: 600;">Show Skill Proof Links</div>
                                    <div style="font-size: 0.9rem; color: var(--secondary);">GitHub, demos, certificates</div>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background-color: #f9f9f9; border-radius: var(--border-radius); padding: 1.5rem;">
                        <h4 style="margin-bottom: 1rem;">Portfolio Preview</h4>
                        <div style="background-color: white; border-radius: var(--border-radius); padding: 1.5rem; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <div class="avatar" style="width: 60px; height: 60px; font-size: 1.5rem;">JD</div>
                                <div>
                                    <div style="font-weight: 700; font-size: 1.2rem;">Nafisaa</div>
                                    <div style="color: var(--secondary);">Senior Frontend Developer</div>
                                </div>
                            </div>
                            <p style="margin-bottom: 1rem;">5+ years of experience in building scalable web applications with React and TypeScript.</p>
                            <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                <span style="background-color: var(--primary-light); color: var(--primary); padding: 0.3rem 0.8rem; border-radius: 4px; font-size: 0.9rem;">React</span>
                                <span style="background-color: var(--primary-light); color: var(--primary); padding: 0.3rem 0.8rem; border-radius: 4px; font-size: 0.9rem;">TypeScript</span>
                                <span style="background-color: var(--primary-light); color: var(--primary); padding: 0.3rem 0.8rem; border-radius: 4px; font-size: 0.9rem;">Node.js</span>
                            </div>
                            <div style="font-size: 0.9rem; color: var(--secondary);">
                                <i class="fas fa-eye"></i> 245 views this month
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
    // --- GLOBAL VARIABLES ---
    const API_BASE_URL = "http://localhost:5000"; // <--- FORCE BACKEND URL
    let generatedResumeHTML = ""; 

    // --- MAIN FUNCTION ---
    async function generateResume() {
        console.log("ðŸš€ Starting Resume Generation...");

        // 1. Get Elements
        const jdInput = document.getElementById('jd-input');
        const btn = document.getElementById('generate-btn'); 

        // 2. Validate Elements Exist
        if (!jdInput || !btn) {
            alert("Error: HTML elements not found. Check IDs 'jd-input' and 'generate-btn'.");
            return;
        }

        // 3. Get Input Data
        const jdText = jdInput.value;
        const originalText = btn.innerHTML;

        if (!jdText || jdText.trim().length < 20) {
            alert('Please paste a valid job description (at least 20 characters).');
            return;
        }

        // 4. Set Loading State
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';
        btn.disabled = true;

        try {
            // 5. Get Auth Token
            const token = localStorage.getItem('token');
            if (!token) {
                alert("You are not logged in. Please log in again.");
                window.location.href = 'login.html';
                return;
            }

            console.log(`ðŸ”— Fetching: ${API_BASE_URL}/api/candidate/generate-resume`);

            // 6. FORCE FETCH TO BACKEND
            const response = await fetch(`${API_BASE_URL}/api/candidate/generate-resume`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'x-auth-token': token
                },
                body: JSON.stringify({ jobDescriptionText: jdText })
            });

            // 7. Check Response Status
            console.log("ðŸ“© Response Status:", response.status);
            
            if (response.status === 404) {
                throw new Error("Server Route Not Found (404). Check server.js routes.");
            }
            
            const data = await response.json(); // <--- THIS FAILS IF HTML IS RETURNED

            if (!response.ok) {
                throw new Error(data.msg || 'Server Error');
            }

            // 8. Success: Process Data
            generatedResumeHTML = marked.parse(data.resumeContent);

            // 9. Update UI (Show Success Card)
            const successCard = document.getElementById('success-card');
            if (successCard) {
                successCard.style.display = 'flex';
                
                // Update Timestamp
                const now = new Date();
                const dateEl = document.getElementById('generated-date');
                if(dateEl) dateEl.textContent = `Generated: Today, ${now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}`;
                
                // Update Company Name
                const companyMatch = jdText.match(/(?:at|for|company)\s+([A-Z][a-z]+(?:\s[A-Z][a-z]+)*)/);
                const tailorEl = document.getElementById('tailored-for');
                if (companyMatch && tailorEl) {
                    tailorEl.textContent = `Tailored for: ${companyMatch[1]}`;
                }
            }

            // Inject Content into Hidden Modal
            const displayEl = document.getElementById('resume-content-display');
            if(displayEl) displayEl.innerHTML = generatedResumeHTML;

            // Final Success Alert
            alert('âœ… Tailored resume generated successfully!');

        } catch (error) {
            console.error("âŒ ERROR:", error);
            
            // specific error handling for the "Unexpected token" issue
            if (error.message.includes("Unexpected token")) {
                alert("CRITICAL ERROR: The server returned HTML instead of JSON.\n\nThis means the Backend URL is wrong or the Route is missing.\n\nCheck Console for details.");
            } else {
                alert('Failed: ' + error.message);
            }
        } finally {
            // Reset Button
            btn.innerHTML = originalText;
            btn.disabled = false;
        }
    }

    // --- HELPER FUNCTIONS ---
    function openPreviewModal() {
        document.getElementById('preview-modal').style.display = 'flex';
    }

    function closePreviewModal() {
        document.getElementById('preview-modal').style.display = 'none';
    }

    function downloadPDF() {
        const element = document.getElementById('resume-content-display');
        
        const opt = {
            margin:       [0.3, 0.5], // [Top/Bottom, Left/Right] in inches
            filename:     'Tailored_Resume.pdf',
            image:        { type: 'jpeg', quality: 0.98 },
            html2canvas:  { 
                scale: 2, 
                scrollY: 0,      // <--- THIS FIXES THE BLANK SPACE ISSUE
                useCORS: true,   // Ensures images load correctly
                logging: false
            },
            jsPDF:        { unit: 'in', format: 'letter', orientation: 'portrait' }
        };
        
        html2pdf().set(opt).from(element).save();
    }

        // Smooth scrolling for sidebar links
        document.querySelectorAll('.sidebar-menu a').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Remove active class from all links
                document.querySelectorAll('.sidebar-menu a').forEach(item => {
                    item.classList.remove('active');
                });
                
                // Add active class to clicked link
                this.classList.add('active');
                
                // Scroll to section
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 100,
                        behavior: 'smooth'
                    });
                }
            });
        });

        // Toggle switches functionality
        document.querySelectorAll('.switch input').forEach(switchInput => {
            switchInput.addEventListener('change', function() {
                const label = this.parentElement.querySelector('.slider');
                if (this.checked) {
                    console.log('Switch turned ON');
                } else {
                    console.log('Switch turned OFF');
                }
            });
        });



                // ---------- AUTH / DASHBOARD LOGIC ----------
                (function () {
                    const token = localStorage.getItem('token');
                    const userStr = localStorage.getItem('user');
        
                    // If not logged in, send back to login page
                    if (!token || !userStr) {
                        window.location.href = 'login.html';
                        return;
                    }
        
                    let user;
                    try {
                        user = JSON.parse(userStr);
                    } catch (e) {
                        console.error('Invalid user in localStorage');
                        localStorage.removeItem('token');
                        localStorage.removeItem('user');
                        window.location.href = 'login.html';
                        return;
                    }
        
                    // This page is only for candidates
                    if (user.role !== 'candidate') {
                        window.location.href = 'login.html';
                        return;
                    }
        
                    // Update header with real name + role
                    const nameEl = document.getElementById('user-name');
                    const roleEl = document.getElementById('user-role');
                    const avatarEl = document.getElementById('user-avatar');
        
                    if (nameEl) nameEl.textContent = user.fullName || 'Candidate';
                    if (roleEl) roleEl.textContent =
                        user.role.charAt(0).toUpperCase() + user.role.slice(1);
        
                    if (avatarEl && user.fullName) {
                        const initials = user.fullName
                            .split(/\s+/)
                            .map(n => n[0]?.toUpperCase())
                            .filter(Boolean)
                            .slice(0, 2)
                            .join('');
                        avatarEl.textContent = initials || 'C';
                    }

                    // Update welcome heading with first name
                    const welcomeHeading = document.getElementById('welcome-heading');
                    if (welcomeHeading) {
                        const firstName = (user.fullName || '').split(/\s+/)[0] || 'there';
                        welcomeHeading.textContent = `Welcome back, ${firstName}!`;
                    }

        
                    // Logout button
                    const logoutBtn = document.getElementById('logout-btn');
                    if (logoutBtn) {
                        logoutBtn.addEventListener('click', () => {
                            localStorage.removeItem('token');
                            localStorage.removeItem('user');
                            window.location.href = 'login.html';
                        });
                    }
                })();
        
    </script>
</body>
</html>